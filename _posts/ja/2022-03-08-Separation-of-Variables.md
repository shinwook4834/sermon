---
title: "変数分離法（Separation of Variables）"
description: >-
  変数分離法について学び、関連する例をいくつか紹介する。
categories: [Mathematics, Differential Equation]
tags: [ODE, First-Order ODEs]
math: true
---

## 変数分離法（Separation of Variables）
**分離可能な方程式（separable equation）**：代数的操作を通じて $g(y)y'=f(x)$ の形で表すことができる方程式。

分離可能な方程式 $g(y)y'=f(x)$ の両辺を $x$ に関して積分すると

$$ \int g(y)y'dx = \int f(x)dx + c $$

を得ることができ、$y'dx=dy$ なので

$$ \int g(y)dy = \int f(x)dx + c $$

のように変数 $x$ に関する式と $y$ に関する式をそれぞれ右辺と左辺に分離することができる。もし $f$ と $g$ が連続関数であれば、上記の積分を計算して与えられた微分方程式の一般解を得ることができる。このような解法を **変数分離法（separation of variables）** と呼ぶ。

## モデリング例：放射性炭素年代測定法（Radiocarbon Dating）
エッツィ（Oetzi）は、エッツタール（Oetztal）アルプスで1991年に発見された新石器時代のミイラである。このミイラの炭素-12に対する炭素-14の比率が生きている有機体の52.5%であれば、Oetziはおおよそいつ頃生きていて死んだのか？
> 大気中と生きている有機体では、炭素-12に対する放射性炭素-14の比率が一定である。有機体が死ぬと、呼吸と食事による炭素-14の吸収が行われなくなるが、炭素-14の崩壊は続くため、放射性炭素の比率が減少する。したがって、化石の放射性炭素比率を大気中の放射性炭素比率と比較して、化石の年代を推定することができる。炭素-14の半減期は5715年である。
{: .prompt-info }

### 解法
常微分方程式 $y'=ky$ を変数分離し、積分すると

$$\frac {dy}{y}=k dt$$

$$ \log |y|=kt+c $$

$$ y=y_{0}e^{kt}\ (y_0=e^c) $$

となる。定数 $k$ を決定するために半減期 $H=5715$ を使用する。

$$ y_{0}e^{kH}=0.5y_0 $$

$$e^{kH}=0.5$$

$$ k=\frac {\log 0.5}{H}=-\frac {0.693}{5715}=-0.0001213 $$

最後に、エッツィ（Oetzi）が死んだ時間 $t$ を求めるために比率52.5%を代入すると

$$ e^{kt}=e^{-.0.0001213t}=0.525$$

$$ t=\frac {\log 0.525}{-0.0001213}=5312$$

$$ \therefore \text{約5300年前} $$

## モデリング例：混合問題
初期にタンクに10kgの塩が溶解した1000Lの水が入っている。塩水が毎分10Lの速度で流入し、この塩水には1リットルあたり0.5kgの塩が溶解している。タンク内の混合溶液はよく撹拌され均一に保たれ、この塩水が毎分10Lの速度で流出する。時間 $t$ でのタンク内の塩の量 $y(t)$ を求めよ。

### 1. モデル設定

$$ y'=\text{rate in} - \text{rate out} $$

塩の流入率は毎分5kgである。塩水の毎分流出量は総塩水容量の0.01なので、塩の毎分流出量は $0.01 y(t)$ である。したがって、モデルは常微分方程式

$$y'=5-0.01y=-0.01(y-500) $$

である。

### 2. モデル解法
先ほど立てた常微分方程式は分離可能である。変数分離し、積分した後、両辺に指数関数を取ろう。

$$ \frac {dy}{y-500}=-0.01 dt $$

$$ \log |y-500| = -0.01t+c^* $$

$$ y-500=ce^{-0.01t} $$

初期にタンク内の塩の量は10kgなので、初期条件は $y(0)=10$ である。上式に $y=10,\ t=0$ を代入すると $10-500=ce^0=c$、したがって $c=-490$ である。

$$ \therefore y(t)=500-490e^{-0.01t} $$

つまり、与えられた状況でのタンク内の塩の量は500kgに指数関数的に近づいて収束することがわかる。

## モデリング例：ニュートンの冷却法則（Newton's Law of Cooling）
冬のあるオフィスビルの昼間の温度が20℃に維持されているとする。暖房は午後10時に切れ、午前6時に再び入る。ある日の午前2時にビル内部の温度が17.4℃だった。外部温度は午後10時に10℃で、午前6時には4℃まで下がった。午前6時に暖房が入るとき、ビル内部の温度は何度だっただろうか？
> **ニュートンの冷却法則（Newton's law of cooling）**  
> ある物体の温度 T の時間に対する変化率は、物体とその周囲の温度差に比例する
{: .prompt-info }

### 1. モデル設定
$T(t)$ をビル内部の温度とし、$T_A$ を外部の温度とする。するとニュートンの冷却法則により

$$ \frac {dT}{dt}=k(T-T_A) $$

となる。

### 2. 一般解
$T_A$ が10℃と4℃の間で変化するということしかわからず、正確にどのような値を取るかわからないため、先ほど立てた式を解くことができない。このような場合は、*より簡単な問題に状況を単純化して解法を試みると役立つことがある*。知っている二つの値の平均は7℃なので、未知の関数 $T_A$ を定数関数 $T_A=7$ と仮定しよう。正確でなくても、求めたい午前6時のビル内部温度 $T$ のおおよその値が得られると期待できる。

定数 $T_A=7$ に対して先ほど立てた常微分方程式は分離可能である。変数分離し、積分して指数関数を取ると一般解を得ることができる。

$$ \frac {dT}{T-7}=k dt $$

$$ \log |T-7|=kt+c^* $$

$$ T(t)=7+ce^{kt} \quad(c=e^{c^*})$$

### 3. 特殊解
午後10時を $t=0$ として選ぶと、与えられた初期条件は $T(0)=20$ となる。このとき得られる特殊解を $T_p$ とする。代入すると

$$ T(0)=7+ce^0=20 $$

$$ c=20-7=13 $$

$$ T_p(t)=7+13e^{kt} $$

### 4. $k$ の決定
午前2時にビル内部温度が17.4℃だったので $T(4)=17.4$ である。代数的に $k$ の値を求め、$T_p(t)$ に $k$ を入れると

$$ T_p(4)=7+13e^{4k}=17.4 $$

$$ e^{4k}=0.8 $$

$$ k=\frac {1}{4} \log 0.8=-0.056 $$

$$ T_p(t)=7+13e^{-0.056t} $$

### 5. 答えと解釈
午前6時は $t=8$ なので

$$ T_p(8)=7+13e^{-0.056\cdot8}=15.3\text{[℃]} $$

## モデリング例：トリチェリの定理（Torricelli's Theorem）
タンクの直径が2mで、穴の直径が1cm、穴を開けたときの水の初期高さが2.25mである。任意の時間におけるタンクの水の高さと、タンクが空になるまでにかかる時間を求めよ。
> **トリチェリの定理（Torricelli's theorem）**  
> 重力の影響下で流出する水の速さは
>
> $$ v(t)=0.600\sqrt{2gh(t)} $$
>
> $h(t)$：時間 $t$ における穴の上の水の高さ
> $g=980\text{cm/s²}$：地表面での重力加速度
{: .prompt-info }

### 1. モデル設定
短い時間 $\Delta t$ の間の流出量 $\Delta V$ は

$$ \Delta V = Av\Delta t \qquad (A: \text{穴の面積})$$

である。$\Delta V$ はタンク内の水の体積の変化 $\Delta V^*$ と等しくなければならない。また

$$ \Delta V^* = -B\Delta h \qquad (B: \text{タンクの断面積}) $$

ここで、$\Delta h(>0)$ は水の高さ $h(t)$ の減少量である。$\Delta V$ と $\Delta V^*$ を等しいとおくと

$$ -B\Delta h = Av\Delta t $$

を得る。ここでトリチェリの定理に従って $v$ を表し、$\Delta t$ を限りなく0に近づけると、次のような1階常微分方程式で表されるモデルを得る。

$$ \frac {\Delta h}{\Delta t} = -\frac {A}{B}v = -\frac{A}{B}0.600\sqrt{2gh(t)} $$

$$ \frac {dh}{dt} = \lim_{t\to0}\frac {\Delta h}{\Delta t} = -26.56\frac {A}{B}\sqrt{h} $$

### 2. 一般解
この常微分方程式は分離可能である。変数分離し、積分すると

$$ \frac {dh}{\sqrt{h}} = -26.56\frac{A}{B}dt $$

$$ 2\sqrt{h} = c^* - 26.56\frac{A}{B}t $$

となる。両辺を2で割り、二乗すると $h=(c-13.28At/B)^2$ を得る。$13.28A/B=13.28 \cdot 0.5^2 \pi /100^2 \pi = 0.000332$ を代入すると一般解

$$ h(t)=(c-0.000332t)^2 $$

を得る。

### 3. 特殊解
初期条件は $h(0)=225\text{cm}$ である。$t=0$ と $h=225$ を代入すると一般解から $c^2=225, c=15.00$ を得て、したがって特殊解

$$ h_p(t)=(15.00-0.000332t)^2 $$

を得る。

### 4. タンクが空になるまでにかかる時間

$$ t = 15.00/0.000332 = 45181 \text{[s]} = 12.6 \text{[h]} $$

## 分離可能な形（separable form）への変換
分離可能でない常微分方程式を $y$ に対する新しい未知関数を導入する変換を通じて分離可能にできる場合もある。

$$ y'=f\left(\frac {y}{x}\right) $$

このような常微分方程式を解くときは $y/x=u$ とおくと

$$ y=ux,\quad y'=u'x+u $$

となるので、$y'=f(y/x)$ に代入すると $u'x=f(u)-u$ を得る。もし $f(u)-u\neq0$ であれば

$$ \frac {du}{f(u)-u}=\frac {dx}{x} $$

と分離される。