---
title: 變數分離法（Separation of Variables）
description: 介紹變數分離法，並提供幾個相關的例子。
categories: [Mathematics, Differential Equation]
tags: [ODE, First-Order ODEs]
math: true
image: /assets/img/math-and-physics-cropped.png
---
## 變數分離法（Separation of Variables）
**可分離方程（separable equation）**：可以通過代數操作轉換成 $g(y)y'=f(x)$ 形式的方程。

對可分離方程 $g(y)y'=f(x)$ 的兩邊關於 $x$ 進行積分，我們得到：

$$ \int g(y)y'dx = \int f(x)dx + c $$ 

由於 $y'dx=dy$，所以：

$$ \int g(y)dy = \int f(x)dx + c $$

這樣我們就可以將關於變數 $x$ 的表達式和關於 $y$ 的表達式分別分離到等式的右邊和左邊。如果 $f$ 和 $g$ 是連續函數，我們就可以計算上述積分，從而得到給定微分方程的通解。這種解法稱為**變數分離法（separation of variables）**。

## 建模例子：放射性碳定年法 （Radiocarbon Dating）
冰人奧茨（Oetzi）是在[人類紀](https://en.wikipedia.org/wiki/Holocene_calendar) 11991年在厄茨塔爾（Oetztal）阿爾卑斯山發現的新石器時代木乃伊。如果這具木乃伊的碳-14與碳-12的比率是活體生物的52.5%，那麼奧茨大約是在什麼時候死亡的？
> 在大氣中和活體生物中，碳-14與碳-12的比率是恆定的。當生物死亡後，由於呼吸和進食而吸收碳-14的過程停止，但碳-14的衰變仍在繼續，因此放射性碳的比率會減少。因此，我們可以通過比較化石中的放射性碳比率與大氣中的放射性碳比率來估計化石的年代。碳-14的半衰期是5715年。
{: .prompt-info }

### 解法
將常微分方程 $y'=ky$ 進行變數分離並積分，我們得到：

$$\frac {dy}{y}=k dt$$

$$ \log |y|=kt+c $$

$$ y=y_{0}e^{kt}\ (y_0=e^c) $$

為了確定常數 $k$，我們使用半衰期 $H=5715$：

$$ y_{0}e^{kH}=0.5y_0 $$

$$e^{kH}=0.5$$

$$ k=\frac {\log 0.5}{H}=-\frac {0.693}{5715}=-0.0001213. $$

最後，為了求出冰人奧茨（Oetzi）死亡的時間 $t$，我們代入比率52.5%：

$$ e^{kt}=e^{-.0.0001213t}=0.525$$

$$ t=\frac {\log 0.525}{-0.0001213}=5312.$$

$$ \therefore \text{推估約5310年前，即人類紀6680年左右死亡}. $$

## 建模例子：混合問題
初始時，一個水箱中裝有1000升水，溶解了10公斤鹽。鹽水以每分鐘10升的速度流入，這種鹽水中每升溶解了0.2公斤鹽。水箱內的混合溶液被充分攪拌以保持均勻，同時以每分鐘10升的速度流出。求時間 $t$ 時水箱內鹽的量 $y(t)$。

### 1. 建立模型

$$ y'=\text{流入率} - \text{流出率}. $$

鹽的流入率是每分鐘2公斤。鹽水的每分鐘流出量是總鹽水容量的0.01，因此鹽的每分鐘流出量是 $0.01 y(t)$。因此，模型是常微分方程：

$$y'=2-0.01y=-0.01(y-200) $$

### 2. 求解模型
我們剛剛建立的常微分方程是可分離的。讓我們進行變數分離，積分，然後對兩邊取指數：

$$ \frac {dy}{y-200}=-0.01 dt $$

$$ \log |y-200| = -0.01t+c^* $$

$$ y-200=ce^{-0.01t}. $$

初始時水箱內的鹽量是10公斤，所以初始條件是 $y(0)=10$。將 $y=10,\ t=0$ 代入上式，我們得到 $10-200=ce^0=c$，因此 $c=-190$。

$$ \therefore y(t)=200-190e^{-0.01t} $$

也就是說，在給定的情況下，水箱內鹽的量會指數地接近並收斂到200公斤。

## 建模例子：牛頓冷卻定律（Newton's Law of Cooling）
冬天某辦公大樓白天的溫度維持在20℃。暖氣在晚上10點關閉，早上6點重新開啟。某天凌晨2點時，建築物內部溫度為17.4℃。外部溫度在晚上10點時為10℃，到早上6點降至4℃。當早上6點暖氣開啟時，建築物內部溫度是多少？
> **牛頓冷卻定律（Newton's law of cooling）**  
> 某物體溫度 T 隨時間的變化率與該物體和其周圍環境的溫度差成正比
{: .prompt-info }

### 1. 建立模型
讓 $T(t)$ 表示建築物內部的溫度，$T_A$ 表示外部溫度。根據牛頓冷卻定律，我們有：

$$ \frac {dT}{dt}=k(T-T_A) $$

### 2. 通解
我們只知道 $T_A$ 在10℃和4℃之間變化，但不知道確切的值，所以無法直接解上面的方程。在這種情況下，*將情況簡化為更簡單的問題可能會有幫助*。已知兩個值的平均是7℃，所以讓我們假設未知函數 $T_A$ 是常數函數 $T_A=7$。雖然可能不太精確，但我們可以期望得到我們要求的早上6點建築物內部溫度 $T$ 的近似值。

對於常數 $T_A=7$，我們剛剛建立的常微分方程是可分離的。進行變數分離，積分，然後取指數，我們可以得到通解：

$$ \frac {dT}{T-7}=k dt $$

$$ \log |T-7|=kt+c^* $$

$$ T(t)=7+ce^{kt} \quad(c=e^{c^*}).$$

### 3. 特解
選擇晚上10點為 $t=0$，則給定的初始條件是 $T(0)=20$。讓我們將得到的特解稱為 $T_p$。代入得：

$$ T(0)=7+ce^0=20 $$

$$ c=20-7=13 $$

$$ T_p(t)=7+13e^{kt}. $$

### 4. 確定 $k$
凌晨2點時建築物內部溫度為17.4℃，所以 $T(4)=17.4$。代數求解 $k$ 的值並將其代入 $T_p(t)$：

$$ T_p(4)=7+13e^{4k}=17.4 $$

$$ e^{4k}=0.8 $$

$$ k=\frac {1}{4} \log 0.8=-0.056 $$

$$ T_p(t)=7+13e^{-0.056t}. $$

### 5. 答案和解釋
早上6點是 $t=8$，所以：

$$ T_p(8)=7+13e^{-0.056\cdot8}=15.3\text{[℃]}. $$

## 建模例子：托里切利定理（Torricelli's Theorem）
一個水箱的直徑為2米，孔的直徑為1厘米，開孔時水的初始高度為2.25米。求任意時間水箱中水的高度，以及水箱排空所需的時間。
> **托里切利定理（Torricelli's theorem）**  
> 在重力影響下流出的水的速度為：
>
> $$ v(t)=0.600\sqrt{2gh(t)}. $$
>
> $h(t)$：時間 $t$ 時孔上方水的高度
> $g=980\text{cm/s²}$：地表重力加速度
{: .prompt-info }

### 1. 建立模型
在短時間 $\Delta t$ 內的流出量 $\Delta V$ 是：

$$ \Delta V = Av\Delta t \qquad (A: \text{孔的面積})$$

$\Delta V$ 必須等於水箱內水體積的變化 $\Delta V^*$。此外：

$$ \Delta V^* = -B\Delta h \qquad (B: \text{水箱的橫截面積}) $$

這裡，$\Delta h(>0)$ 是水高度 $h(t)$ 的減少量。將 $\Delta V$ 和 $\Delta V^*$ 設為相等：

$$ -B\Delta h = Av\Delta t $$

現在根據托里切利定理表示 $v$，並讓 $\Delta t$ 無限接近於0，我們得到以下一階常微分方程模型：

$$ \frac {\Delta h}{\Delta t} = -\frac {A}{B}v = -\frac{A}{B}0.600\sqrt{2gh(t)} $$

$$ \frac {dh}{dt} = \lim_{t\to0}\frac {\Delta h}{\Delta t} = -26.56\frac {A}{B}\sqrt{h}. $$

### 2. 通解
這個常微分方程是可分離的。進行變數分離並積分：

$$ \frac {dh}{\sqrt{h}} = -26.56\frac{A}{B}dt $$

$$ 2\sqrt{h} = c^* - 26.56\frac{A}{B}t $$

兩邊除以2並平方，得到 $h=(c-13.28At/B)^2$。代入 $13.28A/B=13.28 \cdot 0.5^2 \pi /100^2 \pi = 0.000332$，我們得到通解：

$$ h(t)=(c-0.000332t)^2 $$

### 3. 特解
初始條件是 $h(0)=225\text{cm}$。將 $t=0$ 和 $h=225$ 代入通解，得到 $c^2=225, c=15.00$，因此特解為：

$$ h_p(t)=(15.00-0.000332t)^2 $$

### 4. 水箱排空所需的時間

$$ t = 15.00/0.000332 = 45181 \text{[s]} = 12.6 \text{[h]}. $$

## 轉換為可分離形式（separable form）
有時，不可分離的常微分方程可以通過引入關於 $y$ 的新未知函數的變換而變為可分離的。

$$ y'=f\left(\frac {y}{x}\right). $$

當解這樣的常微分方程時，令 $y/x=u$，則：

$$ y=ux,\quad y'=u'x+u $$

將這些代入 $y'=f(y/x)$，得到 $u'x=f(u)-u$。如果 $f(u)-u\neq0$，則：

$$ \frac {du}{f(u)-u}=\frac {dx}{x} $$

這樣就分離了。
