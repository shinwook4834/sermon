<!-- The Footer -->
<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <!-- 왼쪽 영역: 언어 전환 + 저작권 -->
  <div class="d-flex align-items-center gap-3 mb-2 mb-lg-0">
    <!-- 언어 전환 아이콘 -->
    <div class="lang-icons d-flex gap-2 align-items-center">
      {% assign langs = "ko,en" | split: "," %}
      {% for lang in langs %}
        <span
          class="lang-icon"
          role="button"
          tabindex="0"
          title="{% if lang == 'ko' %}한국어{% else %}English{% endif %}"
          aria-current="{% if lang == site.active_lang %}true{% else %}false{% endif %}"
          onclick="changeLang('{{ lang }}')"
          onkeydown="if(event.key==='Enter' || event.key===' ') { changeLang('{{ lang }}'); }"
          style="font-size: 1.4rem; cursor: pointer; user-select: none;"
        >
          {% case lang %}
            {% when 'ko' %}🇰🇷
            {% when 'en' %}🇺🇸
          {% endcase %}
        </span>
      {% endfor %}
    </div>

    <p class="mb-0">
      {{- '©' }}
      <time>
        {{ 'now' | date: '%Y' }} <span data-bs-toggle="tooltip" title="Common Era">CE</span> /
        1{{ 'now' | date: '%Y' }} <span data-bs-toggle="tooltip" title="Holocene Era">HE</span>
      </time>

      {% if site.social.links %}
        <a href="{{ site.social.links[0] }}">{{ site.social.name }}</a>.
      {% else %}
        <em class="fst-normal">{{ site.social.name }}</em>.
      {% endif %}

      {% if site.data.locales[include.lang].copyright.brief %}
        <span
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="{{ site.data.locales[include.lang].copyright.verbose }}"
        >
          {{- site.data.locales[include.lang].copyright.brief -}}
        </span>
      {% endif %}
    </p>
  </div>

  <!-- 오른쪽 영역: 기술 정보 -->
  <p class="mb-0">
    {%- capture _platform -%}
      <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
    {%- endcapture -%}

    {%- capture _theme -%}
      <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v{{ theme.version }}"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a>
    {%- endcapture -%}

    {{ site.data.locales[include.lang].meta | replace: ':PLATFORM', _platform | replace: ':THEME', _theme }}
  </p>
</footer>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    window.changeLang = function(targetLang) {
      const currentPath = window.location.pathname;
      const langs = ["ko", "en"];
      const defaultLang = "en";

      let newPath;

      if (targetLang === defaultLang) {
        // 한국어에서 영어로 바꾸는 경우 → /ko/ 제거
        newPath = currentPath.replace(/^\/ko(\/|$)/, '/');
      } else {
        // 영어에서 한국어로 바꾸는 경우 → /ko 추가
        if (currentPath.startsWith("/ko/")) {
          newPath = currentPath; // 이미 ko면 그대로
        } else {
          newPath = "/ko" + currentPath;
        }
      }

      window.location.pathname = newPath;
    };
  });
</script>